(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{42:function(e,t,a){e.exports=a(84)},47:function(e,t,a){},77:function(e,t,a){},84:function(e,t,a){"use strict";a.r(t);var n=a(15),r=a(0),c=a.n(r),o=a(24),i=a.n(o),s=(a(47),a(14)),u=a(11),l=(a(53),a(38)),m=a.n(l),h=a(39),d=a(87),b=a(88),p=a(85),f=a(2),g=a(5),v=a(6),O=a(7),j=a(4),y=a(8),E=a(3),k=a(65),C=a(13),S="http://localhost:5000",w=function(){function e(){Object(g.a)(this,e)}return Object(v.a)(e,[{key:"get",value:function(e){return fetch("".concat(S).concat(e)).then(function(e){var t=e.json();return e.ok?t:t.then(function(e){throw e})}).catch(function(e){throw e})}},{key:"post",value:function(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)};if(a){var r=localStorage.getItem("token");n.headers.Authorization="Bearer ".concat(r)}return fetch("".concat(S).concat(e),n).then(function(e){var t=e.json();return e.ok?t:t.then(function(e){throw e})}).catch(function(e){throw e})}},{key:"put",value:function(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n={method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)};if(a){var r=localStorage.getItem("token");n.headers.Authorization="Bearer ".concat(r)}return fetch("".concat(S).concat(e),n).then(function(e){var t=e.json();return e.ok?t:t.then(function(e){throw e})}).catch(function(e){throw e})}},{key:"delete",value:function(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n={method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)};if(a){var r=localStorage.getItem("token");n.headers.Authorization="Bearer ".concat(r)}return fetch("".concat(S).concat(e),n).then(function(e){var t=e.json();return e.ok?t:t.then(function(e){throw e})}).catch(function(e){throw e})}}]),e}();function N(e,t){var a={message:e.message?e.message:"Something went wrong!",error:e.error?e.error:{}};t({type:"ERROR",message:a.message,error:a.error}),"token"in a.error&&(localStorage.removeItem("token"),localStorage.removeItem("user"),t({type:"LOGOUT"}))}var I=new(function(e){function t(){return Object(g.a)(this,t),Object(O.a)(this,Object(j.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(v.a)(t,[{key:"login",value:function(e,a){return Object(C.a)(Object(j.a)(t.prototype),"post",this).call(this,e,a,!1)}}]),t}(w)),D="LOGIN",T="LOGOUT";var _=function(e){function t(e){var a;return Object(g.a)(this,t),(a=Object(O.a)(this,Object(j.a)(t).call(this,e))).onClickLogout=a.onClickLogout.bind(Object(E.a)(Object(E.a)(a))),a}return Object(y.a)(t,e),Object(v.a)(t,[{key:"onClickLogout",value:function(){Object(f.a)({},this.props).logout()}},{key:"render",value:function(){var e,t=Object(f.a)({},this.props);return e=t.user.name?c.a.createElement("ul",{className:"navbar-nav"},c.a.createElement("li",{className:"nav-item nav-username"},t.user.name),c.a.createElement("li",{className:"nav-item"},c.a.createElement("button",{type:"submit",className:"btn btn-danger nav-button",onClick:this.onClickLogout},"Logout"))):c.a.createElement("ul",{className:"navbar-nav"},c.a.createElement("li",{className:"nav-item"},c.a.createElement(k.a,{to:"/login",className:"btn btn-default nav-button"},"Login"))),c.a.createElement("nav",{className:"navbar navbar-expand-sm navbar-light bg-light"},c.a.createElement(k.a,{className:"navbar-brand",to:"/"},"Catalog"),c.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarContent","aria-controls":"navbarContent","aria-expanded":"false","aria-label":"Toggle navigation"},c.a.createElement("span",{className:"navbar-toggler-icon"})),c.a.createElement("div",{className:"collapse navbar-collapse navbar-items",id:"navbarContent"},c.a.createElement("ul",{className:"navbar-nav"},e)))}}]),t}(c.a.Component),x=Object(u.b)(function(e){return{user:e.user}},function(e){return{logout:function(){return e(function(e){var t=localStorage.getItem("user"),a=localStorage.getItem("token");t&&localStorage.removeItem("user"),a&&localStorage.removeItem("token"),e({type:T})})}}})(_),L=a(86),B=new(function(e){function t(){return Object(g.a)(this,t),Object(O.a)(this,Object(j.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(v.a)(t,[{key:"post",value:function(e){return Object(C.a)(Object(j.a)(t.prototype),"post",this).call(this,"/api/items",e)}},{key:"put",value:function(e,a){return Object(C.a)(Object(j.a)(t.prototype),"put",this).call(this,"/api/items/".concat(e),a)}},{key:"delete",value:function(e){return Object(C.a)(Object(j.a)(t.prototype),"delete",this).call(this,"/api/items/".concat(e))}}]),t}(w)),A="FETCH_ITEMS",R="CREATE_ITEM";function F(e){return B.get("/api/items/".concat(e)).then(function(e){return e.data}).catch(function(e){throw e})}var P=new(function(e){function t(){return Object(g.a)(this,t),Object(O.a)(this,Object(j.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(v.a)(t,[{key:"get",value:function(e){return Object(C.a)(Object(j.a)(t.prototype),"get",this).call(this,e)}}]),t}(w)),J="FETCH_CATEGORIES";function M(){return function(e){return P.get("/api/categories").then(function(t){return e({type:J,categories:t.data.categories}),t.data}).catch(function(t){throw N(t,e),t})}}var G=function(e){function t(e){var a;return Object(g.a)(this,t),(a=Object(O.a)(this,Object(j.a)(t).call(this,e))).showItemByCategory=a.showItemByCategory.bind(Object(E.a)(Object(E.a)(a))),e.fetchItems(),e.fetchCategories(),a}return Object(y.a)(t,e),Object(v.a)(t,[{key:"showItemByCategory",value:function(e){Object(f.a)({},this.props).fetchItemsByCategory(e)}},{key:"render",value:function(){var e=this,t=Object(f.a)({},this.props);return c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-md-4 col-sm-4 col-5",style:{borderRight:"1px solid #bbbec1"}},c.a.createElement("h4",{className:"col-header"},"Categories"),c.a.createElement("ul",null,c.a.createElement("li",null,c.a.createElement(L.a,{to:"/",onClick:function(){return t.fetchItems()}},"All")),t.categories.map(function(t){return c.a.createElement("li",{key:t.id},c.a.createElement(L.a,{to:"#".concat(t.name.replace(" ","-")),activeStyle:{color:"red"},onClick:function(){e.showItemByCategory(t.id)}},t.name))}))),c.a.createElement("div",{className:"col-md-8 col-sm-8 col-7"},t.user.name?c.a.createElement(k.a,{to:"/new-item"},"Add Item"):"",c.a.createElement("h4",{className:"col-header"},"Latest Items"),c.a.createElement("ul",null,t.items.items.map(function(e){return c.a.createElement("li",{key:e.id},c.a.createElement(k.a,{to:"/item/".concat(e.id)},e.name),c.a.createElement("span",null,"(",e.category.name,")"))}))))}}]),t}(c.a.Component);G.defaultProps={fetchItems:null,fetchCategories:null};var W=Object(u.b)(function(e){return{items:e.items,categories:e.categories,user:e.user}},function(e){return{fetchItems:function(){return e(function(e){return B.get("/api/items").then(function(t){return e({type:A,items:t.data.items})}).catch(function(t){throw N(t,e),t})})},fetchCategories:function(){return e(M())},fetchItemsByCategory:function(t){return e(function(e){return function(t){return B.get("/api/categories/".concat(e,"/items")).then(function(e){return t({type:A,items:e.data.items})}).catch(function(e){throw N(e,t),e})}}(t))}}})(G),z=function(e){function t(e){var a;return Object(g.a)(this,t),(a=Object(O.a)(this,Object(j.a)(t).call(this,e))).state={name:e.name,description:e.description},a.isEditing=e.isEditing,a.handleChangeName=a.handleChangeName.bind(Object(E.a)(Object(E.a)(a))),a.handleChangeDescription=a.handleChangeDescription.bind(Object(E.a)(Object(E.a)(a))),a.handleChangeCategory=a.handleChangeCategory.bind(Object(E.a)(Object(E.a)(a))),a.submit=a.submit.bind(Object(E.a)(Object(E.a)(a))),a.edit=a.edit.bind(Object(E.a)(Object(E.a)(a))),a.create=a.create.bind(Object(E.a)(Object(E.a)(a))),a}return Object(y.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){var e=Object(f.a)({},this.props);e.user.token||this.isEditing||e.history.push("/"),e.fetchCategories()}},{key:"componentWillReceiveProps",value:function(e){var t=Object(f.a)({},e);"item"in t?this.setState(Object(f.a)({},t.item)):this.setState({category_id:t.categories[0].id})}},{key:"handleChangeName",value:function(e){this.setState({name:e.target.value})}},{key:"handleChangeDescription",value:function(e){this.setState({description:e.target.value})}},{key:"handleChangeCategory",value:function(e){this.setState({category_id:parseInt(e.target.value,10)})}},{key:"submit",value:function(){var e=Object(f.a)({},this.state);return!(!e.name||!e.description)&&(this.isEditing?this.edit():this.create())}},{key:"create",value:function(){var e=Object(f.a)({},this.props),t=Object(f.a)({},this.state);e.createItem(t).then(function(t){t&&e.history.push("/item/".concat(t.item.id))})}},{key:"edit",value:function(){var e=Object(f.a)({},this.props),t=Object(f.a)({},this.state);e.updateItem(t.id,t).then(function(t){t&&e.onEditSuccess()})}},{key:"render",value:function(){var e=Object(f.a)({},this.state),t=Object(f.a)({},this.props);return c.a.createElement("div",null,c.a.createElement("h2",null,"New Item"),c.a.createElement("form",{method:"post",onSubmit:function(e){return e.preventDefault()}},c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{htmlFor:"name"},"Name",c.a.createElement("input",{type:"text",id:"name",className:"form-control text-input",name:"name",value:e.name,onChange:this.handleChangeName,maxLength:"100",required:!0}))),c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{htmlFor:"category"},"Category",c.a.createElement("select",{id:"category",className:"form-control",name:"category_id",value:e.category_id,onChange:this.handleChangeCategory},t.categories.map(function(e){return c.a.createElement("option",{key:e.id,value:e.id},e.name)})))),c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{htmlFor:"description"},"Description",c.a.createElement("textarea",{id:"description",className:"form-control text-input",name:"description",rows:"10",value:e.description,onChange:this.handleChangeDescription,required:!0}))),c.a.createElement("input",{type:"hidden",name:"item_id",value:"{{item.id}}"}),c.a.createElement("button",{type:"submit",className:"btn btn-primary",onClick:this.submit},"Submit")))}}]),t}(c.a.Component);z.defaultProps={name:"",description:"",isEditing:!1};var U=Object(u.b)(function(e){return{categories:e.categories,user:e.user}},function(e){return{fetchCategories:function(){return e(M())},createItem:function(t){return e((a=t,function(e){return B.post(a).then(function(t){return e({type:R,item:t.data.item}),t.data}).catch(function(t){throw N(t,e),t})}));var a},updateItem:function(t,a){return e(function(e,t){return function(a){return B.put(e,t).then(function(e){return e.data}).catch(function(e){throw N(e,a),e})}}(t,a))}}})(z),q=a(41),H=a.n(q),$=a(16),K=function(e){function t(e){var a;return Object(g.a)(this,t),(a=Object(O.a)(this,Object(j.a)(t).call(this,e))).state={},a.onSigninSuccess=a.onSigninSuccess.bind(Object(E.a)(Object(E.a)(a))),a.onSigninFailure=a.onSigninFailure.bind(Object(E.a)(Object(E.a)(a))),a}return Object(y.a)(t,e),Object(v.a)(t,[{key:"onSigninSuccess",value:function(e){var t=Object(f.a)({},this.props);t.login(e).then(function(){return t.history.push("/")})}},{key:"onSigninFailure",value:function(){$.toast.error("Something went wrong. Please try again later")}},{key:"render",value:function(){return c.a.createElement("div",null,c.a.createElement("h3",null,"Sign in with Google Account"),c.a.createElement(H.a,{className:"g-signin",scope:"openid email profile",clientId:"631390474610-5kpt48ufa9uh64g364asa6f716739p0d.apps.googleusercontent.com",accessType:"offline",responseType:"code",prompt:"select_account",onSuccess:this.onSigninSuccess,onFailure:this.onSigninFailure}),c.a.createElement("div",{id:"result"}))}}]),t}(c.a.Component),Q=Object(u.b)(function(e){return{error:e.error,user:e.user}},function(e){return{login:function(t){return e(function(e){return function(t){return I.login("/api/login",e).then(function(e){var a={name:e.data.user.name,id:e.data.user.id},n=e.data.token;return localStorage.setItem("user",JSON.stringify(a)),localStorage.setItem("token",n),t({type:D,name:a.name,id:a.id,token:n}),a}).catch(function(e){throw N(e,t),e})}}(t))}}})(K),V=function(e){function t(e){var a;return Object(g.a)(this,t),(a=Object(O.a)(this,Object(j.a)(t).call(this,e))).state={name:"",description:"",user_id:0,id:0},a.itemID=e.match.params.item_id,a.delete=a.delete.bind(Object(E.a)(Object(E.a)(a))),a}return Object(y.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=Object(f.a)({},this.props);F(this.itemID).then(function(t){return e.setState(Object(f.a)({},t.item))}).catch(function(){return t.history.push("/")})}},{key:"delete",value:function(){var e=Object(f.a)({},this.props);e.deleteItem(this.itemID).then(function(){return e.history.push("/")})}},{key:"render",value:function(){var e=Object(f.a)({},this.state),t=Object(f.a)({},this.props),a="";return e.user_id===t.user.id&&(a=c.a.createElement("div",{className:"edit-group"},c.a.createElement(k.a,{className:"btn-edit",to:"/item/".concat(e.id,"/edit")},"Edit"),c.a.createElement(k.a,{className:"btn-edit",to:"#/","data-toggle":"modal","data-target":"#confirmDelete"},"Delete"))),c.a.createElement("div",null,c.a.createElement("h3",null,e.name),c.a.createElement("pre",null,e.description),a,c.a.createElement("div",{className:"modal fade",id:"confirmDelete",tabIndex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},c.a.createElement("div",{className:"modal-dialog",role:"document"},c.a.createElement("div",{className:"modal-content"},c.a.createElement("div",{className:"modal-body"},"Do you really want to delete your item?"),c.a.createElement("div",{className:"modal-footer"},c.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Close"),c.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.delete,"data-dismiss":"modal"},"Delete"))))))}}]),t}(c.a.Component),X=Object(u.b)(function(e){return{user:e.user}},function(e){return{deleteItem:function(t){return e(function(e){return function(t){return B.delete(e).then(function(e){return e.data}).catch(function(e){throw N(e,t),e})}}(t))}}})(V),Y=(a(36),function(e){function t(){return Object(g.a)(this,t),Object(O.a)(this,Object(j.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(v.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t=Object(f.a)({},e.error),a=t.message,n=t.error;$.toast.error(a),Object.keys(n).map(function(e){return Array.isArray(n[e])?$.toast.error(n[e][0]):$.toast.error(n[e])})}},{key:"render",value:function(){return c.a.createElement($.ToastContainer,{hideProgressBar:!0,autoClose:3e3})}}]),t}(c.a.Component));Y.defaultProps={error:{}};var Z=Object(u.b)(function(e){return{error:e.error}},null)(Y),ee=function(e){function t(e){var a;return Object(g.a)(this,t),(a=Object(O.a)(this,Object(j.a)(t).call(this,e))).state={name:"",description:""},a.onSuccess=a.onSuccess.bind(Object(E.a)(Object(E.a)(a))),a}return Object(y.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=Object(f.a)({},this.props);this.itemID=t.match.params.item_id,t.user.token||t.history.push("/"),F(this.itemID).then(function(a){return e.setState(Object(f.a)({},a.item),function(){Object(f.a)({},e.state).user_id!==t.user.id&&t.history.push("/")})}).catch(function(){return t.history.push("/")})}},{key:"onSuccess",value:function(){Object(f.a)({},this.props).history.push("/item/".concat(this.itemID))}},{key:"render",value:function(){var e=Object(f.a)({},this.state),t={id:e.id,name:e.name,description:e.description,category_id:e.category_id};return c.a.createElement(U,{item:t,isEditing:!0,onEditSuccess:this.onSuccess})}}]),t}(c.a.Component),te=Object(u.b)(function(e){return{categories:e.categories,user:e.user}},function(e){return{fetchCategories:function(){return e(M())}}})(ee);a(77);var ae=function(){return c.a.createElement(d.a,{basename:"/catalog-frontend"},c.a.createElement("div",{className:"App"},c.a.createElement(x,null),c.a.createElement("div",{className:"container main-panel"},c.a.createElement(b.a,null,c.a.createElement(p.a,{exact:!0,path:"/",component:W}),c.a.createElement(p.a,{exact:!0,path:"/login",component:Q}),c.a.createElement(p.a,{exact:!0,path:"/item/:item_id",component:X}),c.a.createElement(p.a,{exact:!0,path:"/new-item",component:U}),c.a.createElement(p.a,{exact:!0,path:"/item/:item_id/edit",component:te}),c.a.createElement(p.a,{component:W}))),c.a.createElement(Z,null)))},ne={items:[],page:0,offset:10},re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ne,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case A:return{items:Object(n.a)(t.items)};case R:return{items:[t.item].concat(Object(n.a)(e.items))};default:return e}},ce=localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):{};ce.token=localStorage.getItem("token");var oe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ce,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D:return{id:t.id,name:t.name,token:t.token};case T:return{};default:return e}},ie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case J:return Object(n.a)(t.categories);default:return e}},se={error:{},message:""},ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:se,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ERROR":return{message:t.message,error:Object(f.a)({},t.error)};default:return e}},le=Object(s.c)({items:re,user:oe,categories:ie,error:ue});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(79),a(81);var me=[m.a,h.a];var he=Object(s.d)(le,s.a.apply(void 0,Object(n.a)(me)));i.a.render(c.a.createElement(u.a,{store:he},c.a.createElement(ae,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[42,2,1]]]);
//# sourceMappingURL=main.f7c9599f.chunk.js.map