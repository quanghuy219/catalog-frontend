(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{102:function(e,t,n){"use strict";n.r(t);var a=n(57),r=n(0),o=n.n(r),c=n(27),i=n.n(c),s=(n(47),n(17)),u=n(10),l=(n(53),n(41)),m=n(106),p=n(107),d=n(103),h=n(105),f=n(3),g=n(4),E=n(6),b=n(2),v=n(7),y=n(20),O=n(54),I=n(15),S={API_URL:"https://catalog-backend.herokuapp.com"},j=function(){function e(){Object(f.a)(this,e)}return Object(g.a)(e,[{key:"get",value:function(e){return fetch("".concat(S.API_URL).concat(e)).then(function(e){var t=e.json();return e.ok?t:t.then(function(e){throw e})}).catch(function(e){throw e})}},{key:"post",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)};if(n){var r=localStorage.getItem("token");a.headers.Authorization="Bearer ".concat(r)}return fetch("".concat(S.API_URL).concat(e),a).then(function(e){var t=e.json();return e.ok?t:t.then(function(e){throw e})}).catch(function(e){throw e})}},{key:"put",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a={method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)};if(n){var r=localStorage.getItem("token");a.headers.Authorization="Bearer ".concat(r)}return fetch("".concat(S.API_URL).concat(e),a).then(function(e){var t=e.json();return e.ok?t:t.then(function(e){throw e})}).catch(function(e){throw e})}},{key:"delete",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a={method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)};if(n){var r=localStorage.getItem("token");a.headers.Authorization="Bearer ".concat(r)}return fetch("".concat(S.API_URL).concat(e),a).then(function(e){var t=e.json();return e.ok?t:t.then(function(e){throw e})}).catch(function(e){throw e})}}]),e}(),C={FETCH_ITEMS:"FETCH_ITEMS",CREATE_ITEM:"CREATE_ITEM",UPDATE_ITEM:"UPDATE_ITEM",FETCH_CATEGORIES:"FETCH_CATEGORIES",LOGIN:"LOGIN",LOGOUT:"LOGOUT",SHOW_ERROR_MESSAGE:"SHOW_ERROR_MESSAGE",SHOW_SUCCESS_MESSAGE:"SHOW_SUCCESS_MESSAGE",SHOW_LOADER:"SHOW_LOADER",HIDE_LOADER:"HIDE_LOADER"};function k(){return{type:C.SHOW_LOADER}}function _(){return{type:C.HIDE_LOADER}}function N(e){return{type:C.SHOW_SUCCESS_MESSAGE,message:e}}function w(e,t){var n={message:e.message?e.message:"Something went wrong!",error:e.error?e.error:{}};t(_()),t({type:C.SHOW_ERROR_MESSAGE,message:n.message,error:n.error}),"token"in n.error&&(localStorage.removeItem("token"),localStorage.removeItem("user"),t({type:"LOGOUT"}))}var T=new(function(e){function t(){return Object(f.a)(this,t),Object(E.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(g.a)(t,[{key:"login",value:function(e,n){return Object(I.a)(Object(b.a)(t.prototype),"post",this).call(this,e,n,!1)}}]),t}(j));function A(e){return function(t){return t(k()),T.login("/api/login",e).then(function(e){t(_());var n={name:e.data.user.name,id:e.data.user.id},a=e.data.token;return localStorage.setItem("user",JSON.stringify(n)),localStorage.setItem("token",a),t(function(e,t,n){return{type:C.LOGIN,name:e,id:t,token:n}}(n.name,n.id,a)),t(N(e.message)),n}).catch(function(e){throw w(e,t),e})}}var R=new(function(e){function t(){return Object(f.a)(this,t),Object(E.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(g.a)(t,[{key:"post",value:function(e){return Object(I.a)(Object(b.a)(t.prototype),"post",this).call(this,"/api/items",e)}},{key:"put",value:function(e,n){return Object(I.a)(Object(b.a)(t.prototype),"put",this).call(this,"/api/items/".concat(e),n)}},{key:"delete",value:function(e){return Object(I.a)(Object(b.a)(t.prototype),"delete",this).call(this,"/api/items/".concat(e))}}]),t}(j));function D(e){var t=e.items;return{type:C.FETCH_ITEMS,items:t}}function L(){return function(e){return e(k()),R.get("/api/items").then(function(t){e(_()),e(D(t.data))}).catch(function(t){throw w(t,e),t})}}function M(e){return function(t){return t(k()),R.get("/api/items/".concat(e)).then(function(e){return t(_()),e.data}).catch(function(e){throw w(e,t),e})}}function H(e){return function(t){return t(k()),R.post(e).then(function(e){return t(_()),t(function(e){var t=e.item;return{type:C.CREATE_ITEM,item:t}}(e.data)),t(N(e.message)),e.data}).catch(function(e){throw w(e,t),e})}}function G(e,t){return function(n){return n(k()),R.put(e,t).then(function(e){return n(_()),n(function(e){var t=e.item;return{type:C.UPDATE_ITEM,item:t}}(e.data)),n(N(e.message)),e.data}).catch(function(e){throw w(e,n),e})}}var U=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(E.a)(this,Object(b.a)(t).call(this,e))).onClickLogout=function(){n.props.logout()},n.renderNavbar=function(){return n.props.user.name?o.a.createElement("ul",{className:"navbar-nav"},o.a.createElement("li",{className:"nav-item nav-username"},n.props.user.name),o.a.createElement("li",{className:"nav-item"},o.a.createElement("button",{type:"submit",className:"btn btn-danger nav-button",onClick:n.onClickLogout},"Logout"))):o.a.createElement("ul",{className:"navbar-nav"},o.a.createElement("li",{className:"nav-item"},o.a.createElement(O.a,{to:"/login",className:"btn btn-default nav-button"},"Login")))},n.onClickLogout=n.onClickLogout.bind(Object(y.a)(Object(y.a)(n))),n}return Object(v.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){return o.a.createElement("nav",{className:"navbar navbar-expand-sm navbar-light bg-light"},o.a.createElement(O.a,{className:"navbar-brand",to:"/",onClick:this.props.fetchItems},"Catalog"),o.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarContent","aria-controls":"navbarContent","aria-expanded":"false","aria-label":"Toggle navigation"},o.a.createElement("span",{className:"navbar-toggler-icon"})),o.a.createElement("div",{className:"collapse navbar-collapse navbar-items",id:"navbarContent"},o.a.createElement("ul",{className:"navbar-nav"},this.renderNavbar())))}}]),t}(o.a.Component),x=Object(u.b)(function(e){return{user:e.user}},function(e){return{logout:function(){return e(function(e){var t=localStorage.getItem("user"),n=localStorage.getItem("token");t&&localStorage.removeItem("user"),n&&localStorage.removeItem("token"),e({type:C.LOGOUT})})},fetchItems:function(){return e(L())}}})(U),P=n(104),W=new(function(e){function t(){return Object(f.a)(this,t),Object(E.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(g.a)(t,[{key:"get",value:function(e){return Object(I.a)(Object(b.a)(t.prototype),"get",this).call(this,e)}}]),t}(j));function F(){return function(e){return e(k()),W.get("/api/categories").then(function(t){return e(_()),e(function(e){var t=e.categories;return{type:C.FETCH_CATEGORIES,categories:t}}(t.data)),t.data}).catch(function(t){throw w(t,e),t})}}var B=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(E.a)(this,Object(b.a)(t).call(this,e))).showItemsByCategory=function(e){n.props.fetchItemsByCategory(e).catch(function(e){n.props.history.push("/"),n.props.fetchItems()})},n.state={items:[],categories:[]},n}return Object(v.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchCategories();var e=this.props.match.params.category_id;e?this.showItemsByCategory(e):this.props.fetchItems()}},{key:"componentWillReceiveProps",value:function(e){var t=e.items.allIds.map(function(t){return e.items.byId[t]}),n=e.categories.allIds.map(function(t){return e.categories.byId[t]});this.setState({items:t,categories:n})}},{key:"shouldComponentUpdate",value:function(){return 0!==this.props.categories.length}},{key:"componentDidUpdate",value:function(){var e=this.props.match.params.category_id;if(e){var t=this.props.match.params.category_name,n=this.props.categories.byId[e];t&&t===n.name.replace(" ","-")||this.props.history.push("/category/".concat(n.id,"/").concat(n.name.replace(" ","-")))}}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-4 col-sm-4 col-5",style:{borderRight:"1px solid #bbbec1"}},o.a.createElement("h4",{className:"col-header"},"Categories"),o.a.createElement("ul",null,o.a.createElement("li",null,o.a.createElement(P.a,{exact:!0,to:"/",onClick:this.props.fetchItems},"All")),this.state.categories.map(function(t){return o.a.createElement("li",{key:t.id},o.a.createElement(P.a,{to:"/category/".concat(t.id,"/").concat(t.name.replace(" ","-")),onClick:function(){return e.showItemsByCategory(t.id)}},t.name))}))),o.a.createElement("div",{className:"col-md-8 col-sm-8 col-7"},this.props.user.name&&o.a.createElement(O.a,{to:"/new-item"},"Add Item"),o.a.createElement("h4",{className:"col-header"},"Latest Items"),o.a.createElement("ul",null,this.state.items.map(function(e){return o.a.createElement("li",{key:e.id},o.a.createElement(O.a,{to:"/item/".concat(e.id)},e.name),o.a.createElement("span",null,"(",e.category.name,")"))}))))}}]),t}(o.a.Component),J=Object(u.b)(function(e){return{items:e.items,categories:e.categories,user:e.user}},function(e){return{fetchItems:function(){return e(L())},fetchCategories:function(){return e(F())},fetchItemsByCategory:function(t){return e(function(e){return function(t){return t(k()),R.get("/api/categories/".concat(e,"/items")).then(function(e){t(_()),t(D(e.data))}).catch(function(e){throw w(e,t),e})}}(t))}}})(B),z=n(11),q=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(E.a)(this,Object(b.a)(t).call(this,e))).handleChangeName=function(e){n.setState({name:e.target.value})},n.handleChangeDescription=function(e){n.setState({description:e.target.value})},n.handleChangeCategory=function(e){n.setState({category_id:parseInt(e.target.value,10)})},n.submit=function(){return""!==n.state.name&&""!==n.state.description&&(n.isEditing?n.edit():n.createNewItem())},n.createNewItem=function(){n.props.createItem(n.state).then(function(e){e&&n.props.history.push("/item/".concat(e.item.id))})},n.edit=function(){n.props.updateItem(n.state.id,n.state).then(function(e){e&&n.props.onEditSuccess()})},n.state={name:e.name,description:e.description},n.isEditing=e.isEditing,n}return Object(v.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){this.props.user.token||this.isEditing||this.props.history.push("/"),this.props.fetchCategories()}},{key:"componentWillReceiveProps",value:function(e){if("item"in e)this.setState(Object(z.a)({},e.item));else{var t=e.categories.allIds[0];this.setState({category_id:e.categories.byId[t]})}}},{key:"render",value:function(){var e=this,t=Object(z.a)({},this.state),n=this.props.categories.allIds.map(function(t){return e.props.categories.byId[t]});return o.a.createElement("div",null,!this.isEditing&&o.a.createElement("h2",null,"New Item"),o.a.createElement("form",{method:"post",onSubmit:function(e){return e.preventDefault()}},o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{htmlFor:"name"},"Name",o.a.createElement("input",{type:"text",id:"name",className:"form-control text-input",name:"name",value:t.name,onChange:this.handleChangeName,maxLength:"100",required:!0}))),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{htmlFor:"category"},"Category",o.a.createElement("select",{id:"category",className:"form-control",name:"category_id",value:t.category_id,onChange:this.handleChangeCategory},n.map(function(e){return o.a.createElement("option",{key:e.id,value:e.id},e.name)})))),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{htmlFor:"description"},"Description",o.a.createElement("textarea",{id:"description",className:"form-control text-input",name:"description",rows:"10",value:t.description,onChange:this.handleChangeDescription,required:!0}))),o.a.createElement("input",{type:"hidden",name:"item_id",value:"{{item.id}}"}),o.a.createElement("button",{type:"submit",className:"btn btn-primary",onClick:this.submit},"Submit")))}}]),t}(o.a.Component);q.defaultProps={name:"",description:"",isEditing:!1};var K=Object(u.b)(function(e){return{categories:e.categories,user:e.user}},function(e){return{fetchCategories:function(){return e(F())},createItem:function(t){return e(H(t))},updateItem:function(t,n){return e(G(t,n))}}})(q),Q=n(55),V=n.n(Q),X=n(16),Y=function(e){function t(){var e,n;Object(f.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(E.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r)))).onSigninSuccess=function(e){n.props.login(e).then(function(){return n.props.history.push("/")})},n.onSigninFailure=function(){X.toast.error("Something went wrong. Please try again later")},n}return Object(v.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("h3",null,"Sign in with Google Account"),o.a.createElement(V.a,{className:"g-signin",scope:"openid email profile",clientId:"631390474610-5kpt48ufa9uh64g364asa6f716739p0d.apps.googleusercontent.com",accessType:"offline",responseType:"code",prompt:"select_account",onSuccess:this.onSigninSuccess,onFailure:this.onSigninFailure}),o.a.createElement("div",{id:"result"}))}}]),t}(o.a.Component),Z=Object(u.b)(null,function(e){return{login:function(t){return e(A(t))}}})(Y),$=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(E.a)(this,Object(b.a)(t).call(this,e))).delete=function(){n.props.deleteItem(n.itemID).then(function(){return n.props.history.push("/")})},n.renderEditButton=function(){var e="";return n.state.user_id===n.props.user.id&&(e=o.a.createElement("div",{className:"edit-group"},o.a.createElement(O.a,{className:"btn-edit",to:"/item/".concat(n.state.id,"/edit")},"Edit"),o.a.createElement(O.a,{className:"btn-edit",to:"#/","data-toggle":"modal","data-target":"#confirmDelete"},"Delete"))),e},n.state={name:"",description:"",category:"",author:"",user_id:0,id:0},n.itemID=e.match.params.item_id,n}return Object(v.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.items.byId[this.itemID];t?this.setState(Object(z.a)({},t,{category:t.category.name,author:t.user.name})):this.props.fetchItem(this.itemID).then(function(t){return e.setState(Object(z.a)({},t.item,{category:t.item.category.name,author:t.item.user.name}))}).catch(function(){return e.props.history.push("/")})}},{key:"render",value:function(){var e=this.state,t=e.name,n=e.description,a=e.category,r=e.author;return o.a.createElement("div",null,o.a.createElement("h3",null,t),o.a.createElement("p",null,o.a.createElement("label",{className:"item-label"},"Category:"),a),o.a.createElement("p",null,o.a.createElement("label",{className:"item-label"},"Author:"),r),o.a.createElement("p",null,"Description:"),o.a.createElement("pre",null,n),this.renderEditButton(),o.a.createElement("div",{className:"modal fade",id:"confirmDelete",tabIndex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},o.a.createElement("div",{className:"modal-dialog",role:"document"},o.a.createElement("div",{className:"modal-content"},o.a.createElement("div",{className:"modal-body"},"Do you really want to delete your item?"),o.a.createElement("div",{className:"modal-footer"},o.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Close"),o.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.delete,"data-dismiss":"modal"},"Delete"))))))}}]),t}(o.a.Component),ee=Object(u.b)(function(e){return{items:e.items,user:e.user}},function(e){return{fetchItem:function(t){return e(M(t))},deleteItem:function(t){return e(function(e){return function(t){return t(k()),R.delete(e).then(function(e){return t(_()),t(N(e.message)),e.data}).catch(function(e){throw w(e,t),e})}}(t))}}})($),te=(n(36),function(e){function t(){return Object(f.a)(this,t),Object(E.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(g.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t=Object(z.a)({},e.notification),n=t.message,a=t.error;"ERROR"===t.type?(X.toast.error(n),Object.keys(a).map(function(e){return Array.isArray(a[e])?X.toast.error(a[e][0]):X.toast.error(a[e])})):X.toast.info(n)}},{key:"render",value:function(){return o.a.createElement(X.ToastContainer,{hideProgressBar:!0,autoClose:3e3})}}]),t}(o.a.Component)),ne=Object(u.b)(function(e){return{notification:e.notification}},null)(te),ae=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(E.a)(this,Object(b.a)(t).call(this,e))).onSuccess=function(){n.props.history.push("/item/".concat(n.itemID))},n.state={name:"",description:""},n.itemID=e.match.params.item_id,n}return Object(v.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.user.token||this.props.history.push("/"),this.props.fetchItem(this.itemID).then(function(t){return e.setState(Object(z.a)({},t.item),function(){e.state.user_id!==e.props.user.id&&e.props.history.push("/")})}).catch(function(){return e.props.history.push("/")})}},{key:"render",value:function(){var e=Object(z.a)({},this.state);return o.a.createElement("div",null,o.a.createElement("h2",null,"Edit Item"),o.a.createElement(K,{item:e,isEditing:!0,onEditSuccess:this.onSuccess}))}}]),t}(o.a.Component),re=Object(u.b)(function(e){return{categories:e.categories,user:e.user}},function(e){return{fetchCategories:function(){return e(F())},fetchItem:function(t){return e(M(t))}}})(ae),oe=n(56),ce={display:"block",margin:"0 auto",position:"fixed",top:"30%",left:"50%"};var ie=Object(u.b)(function(e){return{loader:e.loader}},null)(function(e){return o.a.createElement("div",{className:"spinner",style:ce},o.a.createElement(oe.ClipLoader,{color:"#36D7B7",loading:e.loader.loading}))});n(95);var se=function(){return o.a.createElement(m.a,{basename:"/catalog-frontend"},o.a.createElement("div",{className:"App"},o.a.createElement(x,null),o.a.createElement("div",{className:"container main-panel"},o.a.createElement(p.a,null,o.a.createElement(d.a,{exact:!0,path:"/",component:J}),o.a.createElement(d.a,{exact:!0,path:"/category/:category_id",component:J}),o.a.createElement(d.a,{exact:!0,path:"/category/:category_id/:category_name",component:J}),o.a.createElement(d.a,{exact:!0,path:"/login",component:Z}),o.a.createElement(d.a,{exact:!0,path:"/item/:item_id",component:ee}),o.a.createElement(d.a,{exact:!0,path:"/new-item",component:K}),o.a.createElement(d.a,{exact:!0,path:"/item/:item_id/edit",component:re}),o.a.createElement(h.a,{to:"/"}))),o.a.createElement(ne,null),o.a.createElement(ie,null)))},ue={byId:{},allIds:[]},le=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ue,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case C.FETCH_ITEMS:return t.items.reduce(function(e,t){return e.byId[t.id]=t,e.allIds.push(t.id),e},{byId:{},allIds:[]});case C.CREATE_ITEM:var n=Object(z.a)({},e);return n.byId[t.item.id]=t.item,n.allIds.push(t.item.id),Object(z.a)({},n);case C.UPDATE_ITEM:var a=Object(z.a)({},e);return a.byId[t.item.id]=t.item,Object(z.a)({},a);default:return e}},me=localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):{};me.token=localStorage.getItem("token");var pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:me,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case C.LOGIN:return{id:t.id,name:t.name,token:t.token};case C.LOGOUT:return{};default:return e}},de={byId:{},allIds:[]},he=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case C.FETCH_CATEGORIES:return t.categories.reduce(function(e,t){return e.byId[t.id]=t,e.allIds.push(t.id),e},{byId:{},allIds:[]});default:return e}},fe={error:{},message:"",type:""},ge=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case C.SHOW_ERROR_MESSAGE:return{type:"ERROR",message:t.message,error:Object(z.a)({},t.error)};case C.SHOW_SUCCESS_MESSAGE:return{type:"SUCCESS",message:t.message};default:return e}},Ee={loading:!1},be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ee;switch((arguments.length>1?arguments[1]:void 0).type){case C.SHOW_LOADER:return{loading:!0};case C.HIDE_LOADER:return{loading:!1};default:return e}},ve=Object(s.c)({items:le,user:pe,categories:he,notification:ge,loader:be}),ye=(n(97),n(99),[l.a]);var Oe=Object(s.d)(ve,s.a.apply(void 0,Object(a.a)(ye)));i.a.render(o.a.createElement(u.a,{store:Oe},o.a.createElement(se,null)),document.getElementById("root"))},42:function(e,t,n){e.exports=n(102)},47:function(e,t,n){},95:function(e,t,n){}},[[42,2,1]]]);
//# sourceMappingURL=main.01965fa4.chunk.js.map